START CONTROL,
*PROJECT WALLE (DECEMBER 2, 2022)
IDF = ..\_WALLE_IDF_ADEval,
Y,
TIDY,
NORPT,
NOTAB,
OLDNAMES,
CSV2R,
TERSE,
!C,
FINISH CONTROL,
START TABLES,
%JH = 'PROJECT WALL E',  




!======FOR QPS WINDOWS (% + raw - for datachecking)
 
F= CTU'='/CAZ'-'/CZP'-'/SDV/UCH/NPGN/NPTC/TID/RLW40/LBB1/TOC/SPL250/CNZ'*'/URS/
PCS/PRC/LPP55/SER/CLG1/RNC1/DAT/BAL/RBL/CLW7/PBL/MOD/MED,
 
!F=MCB29,        ! ------ Less than 30 base
F=BTS,          ! ------ Blank Tables Suppress - standard
F=BCS,          ! ------ Blank Column Suppress - standard
F=DPR4,          ! ------ Decimal % - standard
F=DPT0,          ! ------ Decimal Raw Count
F=DPA2,          ! ------ Decimal Mean Sum
F=DPS2,          ! ------ Decimal Std
F=BRS,          ! ------ Blank Row Suppress - kindly edit based on tabspecs


!F= SHG1/SIG1/SLA95/SLB95/BRS/NFSL, ! standard by segment

F= SHG-1/SIG1/SLA95/SLB95/NFSL, ! ROUND ROBIN


%UNR = '(UNWEIGHTED BASE)',
%AVG = 'Mean Score<d2>',
%SDV = 'Standard Deviation<d2>',

[*DATA HX = HA,HB,HC,HD]
 
[*DATA HEADERWAVE3 = HA,HB,HC]

F=NBCS,


SELECT WR $WTS,
!SELECT WR $WTS21to65,

[*SET T = 0]

[*INSERT Datasets]




DM $FILTER_LGN =  ($Resp_AD_LGN/NB).($Q32024/NB),
    V = "Ad 16.3 ",

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!
!Header Checking Weighted
[*DO Z = 1:3]
!T #PROFILE[&Z] = $TPROFILE * $[HEADERWAVE3.Z],
!BT = "ALL RESPONDENTS",
[*END Z]

 
DM $Filter_Ad_Aware = 
($TQLGN1/1..5),
($TQLGN1/4..5),
($TQLGN1/1..2),


[*DATA BTAdAware(;)=
ALL RESPONDENTS;
AMONG AWARE OF AD;
AMONG NOT AWARE OF AD
]

FILTER $FILTER_LGN/1,
global bt# = "ALL RESPONDENTS", 
 

!======
[*DO Z = 1:3]
T #[+T] = $TQLGN1 * $[HEADERWAVE3.Z],
BT = "ALL RESPONDENTS",
[*END Z]

!======
[*DO Z = 1:3]
IF ($TQLGN1/4..5), T #[+T] = $TQLGN2 * $[HEADERWAVE3.Z],
BT = "AMONG AWARE OF AD",
[*END Z]

!======
[*DO Z = 1:3]
IF ($TQLGN1/4..5), T #[+T] = $TQLGN3 * $[HEADERWAVE3.Z],
BT = "AMONG AWARE OF AD",
[*END Z]


!======
[*DO Z = 1:3]
IF ($TQLGN1/4..5), T #[+T] = $TQLGN4 * $[HEADERWAVE3.Z],
BT = "AMONG AWARE OF AD",
[*END Z]

!======
[*DO F=1:[BTAdAware.#]]
    [*DO Z = 1:3]
        IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN5 * $[HEADERWAVE3.Z],
        BT = "[BTAdAware.F]",
    [*END Z]
[*END F]


!======
[*DO F=1:[BTAdAware.#]]
    [*DO Z = 1:3]
        IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN6 * $[HEADERWAVE3.Z],
        BT = "[BTAdAware.F]",
    [*END Z]
[*END F]


!======
[*DO F=1:[BTAdAware.#]]
    [*DO Z = 1:3]
        IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN7 * $[HEADERWAVE3.Z],
        BT = "[BTAdAware.F]",
    [*END Z]
[*END F]


!======
[*DO F=1:[BTAdAware.#]]
global bt# = "[BTAdAware.F]",
    
    [*DO Z = 1:3]
    [*SET s = 0]
    [*DO A = 1:1]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN8r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*DO A = 2:[KeyMessagesLGN.#]]
    IF ($Filter_Ad_Aware/[F]), +T #[+T] = $TQLGN8r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN8_TB * $[HEADERWAVE3.Z],
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN8_T2B * $[HEADERWAVE3.Z],
    [*END Z]
[*END F]

!======
[*DO F=1:[BTAdAware.#]]
global bt# = "[BTAdAware.F]",
    
    [*DO Z = 1:3]
    [*SET s = 0]
    [*DO A = 1:1]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN9r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*DO A = 2:[StatementsLGN.#]]
    IF ($Filter_Ad_Aware/[F]), +T #[+T] = $TQLGN9r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN9_TB * $[HEADERWAVE3.Z],
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN9_T2B * $[HEADERWAVE3.Z],
    [*END Z]
[*END F]

!======
[*DO F=1:[BTAdAware.#]]
    [*DO Z = 1:3]
        IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN10 * $[HEADERWAVE3.Z],
        BT = "[BTAdAware.F]",
    [*END Z]
[*END F]



!======
[*DO F=1:[BTAdAware.#]]
global bt# = "[BTAdAware.F]",
    
    [*DO Z = 1:3]
    [*SET s = 0]
    [*DO A = 1:1]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN11r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*DO A = 2:[Statements11LGN.#]]
    IF ($Filter_Ad_Aware/[F]), +T #[+T] = $TQLGN11r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN11_TB * $[HEADERWAVE3.Z],
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN11_T2B * $[HEADERWAVE3.Z],
    [*END Z]
[*END F]

!======
[*DO F=1:[BTAdAware.#]]
global bt# = "[BTAdAware.F]",
    
    [*DO Z = 1:3]
    [*SET s = 0]
    [*DO A = 1:1]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN12r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*DO A = 2:[Statements12LGN.#]]
    IF ($Filter_Ad_Aware/[F]), +T #[+T] = $TQLGN12r[A] * $[HEADERWAVE3.Z],
    [*END A]
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN12_TB * $[HEADERWAVE3.Z],
    [*END Z]

    [*DO Z = 1:3]
    IF ($Filter_Ad_Aware/[F]), T #[+T] = $TQLGN12_T2B * $[HEADERWAVE3.Z],
    [*END Z]
[*END F]


FINISH TABLES,