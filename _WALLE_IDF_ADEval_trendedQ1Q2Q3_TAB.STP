START CONTROL,
*PROJECT WALLE (DECEMBER 2, 2022)
IDF = _WALLE_IDF_ADEval_trendedQ1Q2Q3,
Y,
TIDY,
NORPT,
NOTAB,
OLDNAMES,
CSV2R,
TERSE,
!C,
FINISH CONTROL,
START TABLES,
%JH = 'PROJECT WALL E',  




!======FOR QPS WINDOWS (% + raw - for datachecking)
 
F= CTU'='/CAZ'-'/CZP'-'/SDV/UCH/NPGN/NPTC/TID/RLW40/LBB1/TOC/SPL250/CNZ'*'/URS/
PCS/PRC/LPP55/SER/CLG1/RNC1/DAT/BAL/RBL/CLW7/PBL/MOD/MED,
 
!F=MCB29,        ! ------ Less than 30 base
F=BTS,          ! ------ Blank Tables Suppress - standard
F=BCS,          ! ------ Blank Column Suppress - standard
F=DPR4,          ! ------ Decimal % - standard
F=DPT0,          ! ------ Decimal Raw Count
F=DPA2,          ! ------ Decimal Mean Sum
F=DPS2,          ! ------ Decimal Std
F=BRS,          ! ------ Blank Row Suppress - kindly edit based on tabspecs


!F= SHG1/SIG1/SLA95/SLB95/BRS/NFSL, ! standard by segment

F= SHG-1/SIG1/SLA95/SLB95/NFSL, ! ROUND ROBIN


%UNR = '(UNWEIGHTED BASE)',
%AVG = 'Mean Score<d2>',
%SDV = 'Standard Deviation<d2>',

[*DATA HX = HA,HB,HC,HD]
 
[*DATA HEADERWAVE3 = HA,HB,HC]

F=NBCS,


SELECT WR $WTS,
!SELECT WR $WTS21to65,

[*SET T = 0]



 
IF (($JAN2024/nb+$FEB2024/nb).($PaymentxHeartsResp2/NB).($QPH1/nb))+(($MAR2024/nb).($QPH1/nb)), THEN, 
!~~~~~~~~~~~~MultiSelect
[*DO X = 1:1]
IF $QPH1/4+5, T #[+T] = $SOA_Q1_PaymentXHeart * $[HEADERWAVE3.X],
BT = "Among aware of ad",
[*END X]
END IF,

IF (($JAN2024/nb+$FEB2024/nb).($GsavexHeartsResp/NB).($QSH1/nb))+(($MAR2024/nb).($QSH1/nb)) , THEN, 
!~~~~~~~~~~~~MultiSelect
[*DO X = 1:1]
IF $QSH1/4+5, T #[+T] = $SOA_Q1_GSaveXHearts * $[HEADERWAVE3.X],
BT = "Among aware of ad",
[*END X]
END IF,

IF (($Q12024/nb).($QGI1/nb)), THEN, 
!~~~~~~~~~~~~MultiSelect
[*DO X = 1:1]
IF $QGI1/4+5, T #[+T] = $SOA_Q1_GInsureXHearts * $[HEADERWAVE3.X],
BT = "Among aware of ad",
[*END X]
END IF,

IF (($JAN2024/nb+$FEB2024/nb).($GstocksxHeartsResp/NB).($QST1/nb))+(($MAR2024/nb).($QST1/nb)), THEN, 
!~~~~~~~~~~~~MultiSelect
[*DO X = 1:1]
IF $QST1/4+5, T #[+T] = $SOA_Q1_GStocksXHeart * $[HEADERWAVE3.X],
BT = "Among aware of ad",
[*END X]

END IF,

IF (($Q12024/nb).($QSC1/nb))+(($Q22024/nb).($f_GinsureXHeartsQ2/NB)), THEN,
!~~~~~~~~~~~~MultiSelect
[*DO X = 1:1]
IF $QSC1/4+5, T #[+T] = $SOA_Q2_SummerCampaign * $[HEADERWAVE3.X],
BT = "Among aware of ad",
[*END X]
END IF,





IF $FILTER_BLS/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_BLS/6,             T #[+T] = $SOA_Q3_BLS * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_BLG/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_BLG/6,             T #[+T] = $SOA_Q3_BLG * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_LEND/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_LEND/6,             T #[+T] = $SOA_Q3_LEND * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_LOAN/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_LOAN/6,             T #[+T] = $SOA_Q3_LOAN * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_ADZ_1/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_ADZ/6,             T #[+T] = $SOA_Q3_ADZ * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_LGW/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_GcreditWater/6,             T #[+T] = $SOA_Q3_GcreditWater * $[HEADERWAVE3.X],
[*END X]
END IF,

IF $FILTER_LGN/1, THEN,
[*DO X = 1:1]
IF $Aware_Q3_GcreditNextTime/6,             T #[+T] = $SOA_Q3_GcreditNextTime * $[HEADERWAVE3.X],
[*END X]
END IF,
ORDM $Resp_AD_ADZ_SEP24_Before	 = $resp/39010619+39029936+39058815+39058817+39058820+39059551+39073438+39073439+39073440+39073441+39082094+39082802+39084446+39084447+39084448+39086943+39089653+39089988+39091624+39091628+39091629+39093742+39093743+39093744+39095509+39095510+39095511+39095512+39106875+39107075+39107076+39107077+39107078+39107083+39107084+39107085+39107087+39107088+39107090+39107091+39117488+39117490+39117707+39118050+39118051+39118052+39123986+39124020+39124023+39124117+39124444+39124446+39134318+39134319+39135415+39135416+39136668+39136671+39136672+39137116+39137118+39137588+39140745+39140747+39140749+39141059+39141941+39146133+39146134+39146135+39146138+39151634+39152225+39152226+39152228+39154271+39154272+39155730+39155731+39155732+39160098+39160099+39160100+39160101+39161898+39161899+39161900+39161902+39164084+39164088+39164103+39164105+39164114+39164217+39166870+39166897+39170909+39170910+39172234+39172235+39174752+39174753+39174754+39174755+39175678+39175680+39177632+39177634+39178848+39178849+39178850+39179696+39179803+39179804+39179805+39179806+39180716+39184675+39184676+39185044+39185045+39185749+39187914+39187915+39187916+39187917+39190142+39190143+39193165+39193167+39193496+39193498+39193977+39194193+39195330+39195334+39195335+39195406+39195407+39196537+39196538+39196539+39199384+39199385+39199397+39200003+39200409+39200451+39207595+39207596+39209394+39209398+39209891+39210111+39210521+39210522+39210523+39210524+39210665+39213556+39214106+39214108+39214560+39214561+39215622+39215623+39216732+39216734+39218413+39218974+39218975+39218976+39218977+39218978+39218979+39219560+39220578+39220616+39220617+39221179+39221180+39221423+39221424+39221426+39221428+39221429+39221583+39224010+39224013+39224240+39224241+39224242+39224243+39224244+39224248+39225710+39226358+39226359+39226360+39226361+39226362+39226363+39226616+39227201+39227803+39227808+39228038+39228039+39231355+39232163+39234676+39234678+39236686+39236699+39236703+39236793+39236794+39236795+39236796+39237842+39241078+39241079+39241080+39241081+39241083+39248087+39250540+39251264+39255689+39266021+39266022+39266023+39266384+39266385+39266386+39266387+39266388+39266389+39267421+39267422+39267423+39267635+39272407+39273355+39273831+39276058+39280033+39280034+39281400+39281401+39281930+39281931+39281932+39281933+39281934+39286878+39287899+39289502+39290348+39290349+39291108+39291110+39292843+39294709+39305015+39305016+39305017+39305018+39305019+39305020+39305021+39308304+39308371+39309508+39310400+39310463+39310465+39310466+39311659+39311921+39311922+39312593+39312594+39312595+39312639+39312859+39312861+39312862+39312863+39312864+39313967+39313969+39313970+39316786+39316787+39317465+39317466+39317467+39317468+39317469+39319278+39319279+39319280+39320948+39326651+39326825+39327330+39328392+39328883+39328884+39328887+39328888+39328890+39329205+39329437+39330023+39330714+39330715+39331167+39332366+39332367+39332368+39333381+39337221+39337639+39339234+39339235+39339236+39339237+39341701+39341703+39344034+39344088+39344089+39344183+39345271+39345857+39346047+39346048+39346049+39346050+39346280+39346694+39346695+39346696+39346697+39346698+39346699+39346700+39347263+39347568+39347570+39347571+39347572+39347573+39347653+39347654+39349630+39349631+39349632+39351744+39353056+39353057+39353058+39353064+39353066+39353067+39353768+39353769+39353770+39353771+39354451+39354734+39354735+39354736+39354737+39354780+39354783+39355108+39355253+39355617+39355708+39355709+39355710+39355711+39356219+39356876+39356877+39356879+39356880+39357412+39357413+39357414+39357415+39359538+39359539+39359540+39359541+39359542+39359543+39359655+39360039+39360040+39360041+39360043+39360044+39360045+39360054+39360055+39360056+39360058+39360060+39360061+39360106+39360111+39360112+39360113+39360116+39360208+39360325+39362223+39362224+39362598+39362599+39362600+39362601+39362602+39362603+39362604+39368073+39368383+39368416+39368417+39368418+39368834+39368835+39369166+39374453+39374893+39374894+39374895+39374896+39374897+39374898+39374899+39376547+39376548+39376549+39376550+39379617+39379765+39380168+39380169+39380246+39380254+39380695+39380696+39381305+39381306+39381931+39381932+39387009+39387010+39387011+39387013+39388461+39388462+39393542+39393543+39401757+39402113+39402577+39402622+39402650+39402653+39402654+39403085+39403125+39404265+39404841+39404843+39405126+39405158+39405710+39413448+39413624+39413625+39414374+39414375+39416786+39418917+39418918+39421251+39421252+39421255+39423344+39424065+39427367+39428443+39428444+39428446+39428448+39428449+39428450+39428912+39428913+39428914+39431147+39431148+39432500+39435303+39435305+39435306+39435307+39437927+39437929+39437930+39438099+39438100+39440201+39440202+39440203+39440204+39440205+39442042+39442043+39442689+39442811+39449856+39449858+39449859+39449860+39449861+39449986+39452033+39453020+39453021+39457116+39465220+39465221+39478910+39478911+39478912+39478913+39492209+39492210+39492211+39492212+39492213+39492401+39492402+39492403+39492404+39494254+39494255+39497097,
ORDM $Resp_AD_ADZ_SEP24_Onward	 = $resp/39694339+39694340+39694341+39694342+39705416+39706612+39709742+39717119+39717120+39722661+39722664+39733132+39733134+39733250+39733251+39734827+39734828+39734829+39736606+39737240+39737241+39737242+39737243+39737244+39743925+39743926+39743927+39744129+39748505+39748506+39749462+39751345+39752871+39752872+39752873+39752874+39753028+39753956+39753957+39754256+39754258+39754299+39754300+39754301+39754981+39755101+39755102+39755103+39755104+39755105+39755171+39756334+39756335+39756336+39757329+39757580+39757581+39757585+39758141+39758201+39758202+39758204+39758582+39759380+39759381+39762367+39762369+39762582+39762583+39762783+39762784+39762785+39763571+39763572+39763573+39763574+39763575+39763576+39764840+39764841+39768555+39768557+39769200+39770819+39770820+39770911+39771585+39771586+39771587+39771689+39771728+39772160+39772334+39772628+39772853+39772854+39772899+39772900+39773005+39773007+39773008+39773431+39773432+39775160+39779367+39780298+39780299+39780300+39780758+39781022+39781023+39781130+39782106+39782107+39782514+39782515+39784212+39784213+39785991+39785993+39785994+39785995+39786467+39786852+39787091+39787092+39787093+39787094+39788293+39789234+39789235+39789236+39789521+39789831+39789832+39789849+39789850+39789851+39790348+39790717+39790718+39790719+39791589+39791992+39792198+39792471+39792472+39792473+39792696+39792858+39792869+39792870+39792871+39792872+39792873+39792874+39793198+39793426+39794678+39794817+39795549+39796306+39796308+39796309+39796310+39796656+39797020+39797272+39797273+39797274+39797275+39797276+39797278+39797279+39797280+39797281+39797457+39797458+39797924+39797925+39797926+39797927+39797928+39798105+39798520+39798521+39798522+39798523+39798653+39798654+39798656+39798925+39798926+39798927+39799191+39799312+39800794+39800795+39801100+39801102+39801103+39801104+39801105+39801106+39801285+39801287+39801301+39801302+39801303+39801304+39801305+39801306+39801307+39801506+39801507+39801642+39801743+39801841+39801842+39801896+39802755+39802827+39802828+39802829+39802830+39804103+39804104+39804175+39804176+39804932+39805910+39805911+39806961+39809779+39809780+39809781+39809782+39809876+39809877+39809878+39810492+39810493+39810495+39810496+39810497+39810499+39811454+39812447+39812449+39813206+39813995+39814280+39814281+39814282+39814283+39814352+39814616+39814860+39814861+39814862+39815673+39815679+39815680+39816451+39816452+39816453+39816547+39817134+39819170+39819426+39819447+39820266+39820289+39820290+39820291+39820292+39820313+39820314+39820315+39820318+39820913+39823067+39823068+39823127+39823128+39823665+39829443+39829444+39829445+39829446+39829447+39829448+39829449+39831557+39831558+39832869+39832870+39832872+39835113+39835114+39835131+39835351+39835419+39835420+39835642+39835643+39835801+39835802+39835803+39835804+39835858+39836165+39836632+39836966+39836968+39837205+39837459+39837460+39837516+39837517+39838227+39838228+39838229+39838230+39838344+39840828+39840829+39841518+39841673+39841949+39846430+39846431+39846789+39847500+39849777+39849778+39849779+39849780+39849781+39850736+39850759+39850760+39850891+39853174+39853194+39853195+39853311+39853312+39853313+39853314+39853316+39855968+39855969+39857230+39857231+39862339+39862340+39862341+39864724+39865061,
ORDM $Resp_AD_ADZ_SEP24_Before	 = $resp/39530029+39530030+39530031+39530587+39530589+39546904+39546905+39546906+39546907+39546908+39553866+39553867+39553868+39557083+39558915+39559857+39566101+39576698+39576699+39576700+39583038+39583039+39583040+39583723+39583724+39583725+39583726+39583728+39583729+39587535+39589462+39589463+39589464+39589467+39595105+39595107+39595108+39595109+39595325+39595326+39600471+39602354+39602355+39602356+39602357+39602358+39602359+39610011+39611895+39611896+39613934+39613935+39613939+39613941+39613943+39615714+39615715+39615716+39615718+39615719+39615720+39618273+39618274+39620579+39620580+39620581+39621250+39621995+39621996+39621997+39622804+39622806+39622807+39622808+39626868+39627177+39627178+39633752+39633753+39633754+39633755+39634129+39634130+39634268+39634269+39635510+39637912+39637913+39637917+39637918+39637919+39637921+39638296+39638297+39641384+39641386+39641387+39642565+39642566+39642567+39642568+39645012+39645013+39645014+39646921+39649192+39650536+39650539+39650540+39651825+39651826+39654961+39654962+39655476+39655477+39655478+39655479+39656503+39656504+39656505+39656678+39657221+39657223+39657225+39659455+39662558+39662559+39664365+39664366+39666382+39666383+39666384+39667077+39667079+39669889+39669933+39669934+39669935+39670460+39671461+39673826+39673830+39677745+39677748+39677749+39679235+39679236+39680322+39680323+39680324+39680325+39680326+39681100+39681102+39681103+39681104+39687561+39687562+39689676+39689677+39689678+39692452+39692453+39692620+39692622+39693246+39693247+39693248+39698674+39698675+39698677+39698678+39698680+39698683+39698684+39699006+39699007+39699542+39699543+39699544+39699779+39699780+39700170+39700713+39703876+39703877+39704866+39705253+39705254+39705255+39706302+39706303+39707349+39707351+39723268+39723269+39723270+39723271+39723272+39723273+39723274+39723275+39723276+39723277+39723278+39723415+39723416+39727139+39732188+39732190+39732191+39750972+39750973+39754406+39754407+39754770+39754774+39759305+39760063+39764255+39764256+39764257+39771531+39771532+39771533+39772299+39772300+39782421+39791930+39791931+39819409+39819411+39819412+39819413+39835319+39835320+39835321+39868110+39868111+39868112,

DM $FILTER_ADZ_2 =  ($Resp_AD_ADZ_SEP24_Before/NB).($Q32024/NB),
DM $FILTER_ADZ_3 =  ($Resp_AD_ADZ_SEP24_Onward/NB).($Q32024/NB),
DM $FILTER_ADZ_1 =  ($FILTER_ADZ_2/NB)+($FILTER_ADZ_3/NB),

IF $FILTER_ADZ_1/1, THEN,
[*DO X = 1:1]
T #[+T] = $Aware_Q3_ADZ * $[HEADERWAVE3.X],
[*END X]
END IF,

 


FINISH TABLES,